<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Breaking Rules Stock</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --bg: #0f172a;          /* fondo oscuro */
            --card: #1e293b;        /* tarjetas */
            --primary: #e5e7eb;     /* texto principal */
            --accent: #9ca3af;      /* gris logo */
            --border: #334155;
            --success: #22c55e;
            --danger: #ef4444;
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
            background: var(--bg);
            color: var(--primary);
        }

        header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 18px 28px;
            border-bottom: 1px solid var(--border);
            background: #020617;
        }

        header img {
            height: 42px;
        }

        header h1 {
            font-size: 1.3rem;
            font-weight: 600;
            letter-spacing: .5px;
        }

        .container {
            max-width: 900px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .card {
            background: var(--card);
            border-radius: 14px;
            padding: 24px;
            box-shadow: 0 10px 30px rgba(0,0,0,.35);
            border: 1px solid var(--border);
        }

        h2 {
            margin-top: 0;
            font-weight: 600;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }

        th, td {
            padding: 12px 10px;
            border-bottom: 1px solid var(--border);
            text-align: left;
        }

        th {
            font-size: .8rem;
            text-transform: uppercase;
            color: var(--accent);
            letter-spacing: .6px;
        }

        .actions a {
            text-decoration: none;
            font-size: .85rem;
            padding: 6px 10px;
            border-radius: 8px;
            background: rgba(239,68,68,.15);
            color: var(--danger);
            transition: .2s;
        }

        .actions a:hover {
            background: rgba(239,68,68,.25);
        }

        .empty {
            text-align: center;
            color: var(--accent);
            padding: 30px 0;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            font-size: .8rem;
            color: var(--accent);
        }

        .stock-bajo {
            background: rgba(239, 68, 68, 0.15);
        }

        .badge {
            padding: 3px 8px;
            border-radius: 6px;
            font-size: .75rem;
            font-weight: 600;
        }

        .badge-danger {
            background: rgba(239,68,68,.2);
            color: #ef4444;
        }
    </style>
</head>
<body>

<header>
    <img src="/logo-br.jpeg" alt="Breaking Rules logo">
    <h1>Breaking Rules Stock</h1>
</header>

    <div class="card">
        <h3>➕ Crear producto</h3>

        <form th:action="@{/web/productos}"
              th:object="${productoNuevo}"
              method="post">

            <input type="text" th:field="*{nombre}" placeholder="Nombre" required>
            <input type="text" th:field="*{categoria}" placeholder="Categoría" required>
            <input type="text" th:field="*{color}" placeholder="Color" required>

            <select th:field="*{talle}">
                <option value="XS">L</option>
                <option value="S">S</option>
                <option value="M">M</option>
                <option value="L">L</option>
                <option value="XL">XL</option>
                <option value="XXL">XXL</option>
                <option value="XXXL">XXXL</option>
            </select>

            <input type="number" step="0.01" th:field="*{precio}" placeholder="Precio" required>
            <input type="number" th:field="*{stock}" placeholder="Stock" required>

            <button type="submit">Guardar</button>
        </form>
    </div>

    <div class="container">
        <div class="card">
            <h2>Productos</h2>
            <form th:action="@{/web/productos}" method="get">
                <input type="text" name="nombre" placeholder="Buscar por nombre">
                <button type="submit">Buscar</button>
            </form>
            <p th:if="${productos.?[stock <= 5].size() > 0}"
               style="color:#ef4444; font-size:.9rem;">
                ⚠ Hay productos con stock crítico
            </p>
            <table th:if="${productos != null and !productos.isEmpty()}">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Precio</th>
                    <th>Stock</th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="p : ${productos}"
                    th:classappend="${p.stock <= 5} ? 'stock-bajo'">
                    <td th:text="${p.id}"></td>
                    <td th:text="${p.nombre}"></td>
                    <td th:text="${p.precio}"></td>
                    <td>
                        <span th:text="${p.stock}"></span>
                        <span th:if="${p.stock <= 5}" class="badge badge-danger">Bajo</span>
                    </td>
                    <td class="actions">
                        <a th:href="@{'/web/productos/eliminar/' + ${p.id}}">Eliminar</a>
                        <a th:href="@{'/web/productos/editar/' + ${p.id}}">Editar</a>
                    </td>
                </tr>
                </tbody>

            </table>

            <div class="empty" th:if="${productos == null or productos.isEmpty()}">
                No hay productos cargados todavía.
            </div>
        </div>

        <footer>
            © 2026 Breaking Rules — Portfolio Project
        </footer>
    </div>
</body>
</html>
